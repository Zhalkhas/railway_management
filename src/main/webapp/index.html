<!DOCTYPE html>

<html lang="en">

<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="railway.css">
	<title>Railway Station</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"> </script>
</head>

<body>
<div class="search">
	<h3>
		FIND TICKETS
	</h3>

	<form>
		<input type="text" id= "from" name="route_from" placeholder="From">
		<input type="text" id = "to" name="route_to" placeholder="To">
		<input type="date" id="departureDate" data-date-inline-picker="true" name="departure_date" placeholder="Departure date">
<!--		<input type="date" id="returnDate" data-date-inline-picker="true" name="return_date" placeholder="Return date">-->

	</form>
	<button type="button" id="main_button" onclick="findFunction()">Find</button><br>
</div>
<h3>
	<button type="button" id="signin" onclick="openBox()">Sign In</button><br>
</h3>
<div class="profile">

	<form class = "bevertical">
		<input type="text" name="e-mail" placeholder="e-mail"><br>
		<input type="password" name="password" placeholder="password"><br>
		<button type="button"  id="second_button" onclick="signUpFunction()"><a style="text-decoration:none" href="regsitration.html">Sign Up</button>

		<button type="button" id="second_button" onclick="signInFunction()"><a> Sign In</button>
	</form>
</div>

<div class="schedule">
	<div class="route_table">
		<table id="table">
			<tr>
				<th>Departure</th>
				<th>Destination</th>
				<th>Time</th>
<!--				<th>Train id</th>-->
			</tr>
		</table>

	</div>
</div>


<script>

	$('div.profile').hide();
	function openBox(){
		$('div.profile').toggle();

	}

	function signInFunction(){

	}

	function signUpFunction(){

	}

	function findFunction(e){
		var from = $('#from').val();
		var to = $('#to').val();
		var departureDate = $('#departureDate').val();


		$.get("api/search/getRoutes", {
				   dept: from,
						 dest:to,
					date: departureDate},
			   function(r) {
				   updateList(r);
				   //location.replace("/schedule")
			   });

	}

	// function getListItems() {
	//         $.ajax({
	//         type : "GET"
	//           url : 'api/search/getRoutes',
	//           dataType : 'json',
	//           success : function(r) {
	//                 updateList(r);
	//               }
	//     })
	//     }

	function updateList(items){
		$("#table_of_routes").html("");
		// var arrTime = items.arrivalTime;
		// var traiID = items.trainID;

		console.log(typeof (items));
		items = JSON.parse(items);
		console.log(items.name1)
		console.log(items)
		items.forEach(function (index){
			var from = index.name1;
			var to = index.name2;
			var depTime = index.departureTime;

			// var destTime = items.arrivalTime;
			$("#table").append("<tr><td>" + from + "</td><td>" + to + "</td><td>" + depTime + "</td></tr>");
		});
	}
</script>
</body>

</html>