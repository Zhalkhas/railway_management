<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" type="text/css" href="railway.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">


    <title>Passenger Profile Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"> </script>
</head>

<body>
<div class="w3-container w3-center w3-margin">
    <h1  style="color: #ffffff ">Passenger Profile Page</h1>
</div>




<div class="w3-container w3-left w3-margin-top">
    <h2 class="w3-wide">Past Trips</h2>
</div>

<div>
    <table class="w3-table w3-bordered w3-margin-top">
        <!--        <thead>-->
        <tr >
            <th class="w3-center w3-text-black">Ticket ID</th>
            <th class="w3-center w3-text-black">Departure Time</th>
            <th class="w3-center w3-text-black">Arrival Time</th>
            <th class="w3-center w3-text-black">Departure Station Name</th>
            <th class="w3-center w3-text-black">Arrival Station Name</th>
            <th class="w3-center w3-text-black">Train id</th>
        </tr>
        <!--        </thead>-->
        <tbody id="tablePast">

        </tbody>
    </table>
</div>

<div class="w3-container w3-left w3-margin-top">
    <h2 class="w3-wide">Future Trips</h2>
</div>
<div>
    <table class="w3-table w3-bordered w3-margin-top">
        <!--        <thead>-->
        <tr >
            <th class="w3-center w3-text-black">Ticket ID</th>
            <th class="w3-center w3-text-black">Departure Time</th>
            <th class="w3-center w3-text-black">Arrival Time</th>
            <th class="w3-center w3-text-black">Departure Station Name</th>
            <th class="w3-center w3-text-black">Arrival Station Name</th>
            <th class="w3-center w3-text-black">Train id</th>
        </tr>
        <!--        </thead>-->
        <tbody id="tableFuture">

        </tbody>
    </table>
</div>


<div class="w3-center w3-margin-top" >
    <a href="index.html" id="main_button"  >Go To Search</a> <br>
</div>




<script>
    function updateListOfPastTrips(items) {
        $("#table_of_trips tbody tr").remove();
        $("#table_of_trips").html("");
        items = JSON.parse(items);

        items.forEach(function (index) {
            var ticketId = index.ticketId;
            var depTime = index.depTime;
            var arrivalTime = index.arrivalTime;
            var depStationName = index.depName;
            var arrivalStationName = index.arrivalName;
            var trainId = index.trainId;


            $("#tablePast").append("<tr><td class=\"column1\">"
                                   + ticketId + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column2\">"
                                   + depTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column3\">"
                                   + arrivalTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column4\">"
                                   + depStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                                   + arrivalStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                                   + trainId + "</td><button type='button' onclick='bookFunction()'>book</button><br></tr><br>");
        });
    }

    function updateListOfFutureTrips(items) {
        $("#table_of_trips tbody tr").remove();
        $("#table_of_trips").html("");
        items = JSON.parse(items);

        items.forEach(function (index) {
            var ticketId = index.ticketId;
            var depTime = index.depTime;
            var arrivalTime = index.arrivalTime;
            var depStationName = index.depName;
            var arrivalStationName = index.arrivalName;
            var trainId = index.trainId;


            $("#tableFuture").append("<tr><td class=\"column1\">"
                                     + ticketId + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column2\">"
                                     + depTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column3\">"
                                     + arrivalTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column4\">"
                                     + depStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                                     + arrivalStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                                     + trainId + "</td><button type='button' onclick='bookFunction()'>book</button><br></tr><br>");
        });
    }




    function getPastTrips(){
        $.get("api/ticket/allPastTickets", {
                  userId: 1}, //TODO: userId should be here

              function(r) {
                  updateListOfPastTrips(r);
              });
    }

    function getFutureTrips(){
        $.get("api/ticket/allFutureTickets", {
                  userId: 1}, //TODO: userId send from the login page

              function(r) {
                  updateListOfFutureTrips(r);
              });
    }

    $(document).ready(function (){
        getPastTrips();
        getFutureTrips();
    });
</script>
</body>
</html>