<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" type="text/css" href="railway.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <title>Manager Profile Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"> </script>
</head>
<body>
<div class="w3-container w3-center w3-margin">
    <h1 style="color: #ffffff ">Manager Profile Page</h1>
</div>

<div class="w3-container w3-left w3-margin-top">
    <h2 class="w3-wide">Schedule</h2>
</div>

<div>
    <table class="w3-table w3-bordered w3-margin-top">

        <tr >
            <th class="w3-center w3-text-black">Train Number</th>
            <th class="w3-center w3-text-black">Departure Time</th>
            <th class="w3-center w3-text-black">Arrival Time</th>
<!--            <th class="w3-center w3-text-black">Schedule ID</th>-->
            <th class="w3-center w3-text-black">From</th>
            <th class="w3-center w3-text-black">To</th>
            <th class="w3-center w3-text-black">Availability</th>
            <th class="w3-center w3-text-black">Route is closed?</th>
            <th class="w3-center w3-text-black">Maintenance of the route</th>
        </tr>

        <tbody id="tableSchedule">

        </tbody>
    </table>

</div>

<div>

    <h2 class="w3-wide w3-margin">Create Route</h2>

    <form class="w3-margin-bottom">

        <input type="text" id="trainID" name="trainID" placeholder="Train number" class="w3-margin">

        <input type="text" id="from" name="from" placeholder="From"  class="w3-margin">

        <input type="datetime-local"  id="depTime" data-date-inline-picker="true" name="departure from"
               placeholder="Departure date and time" class="w3-margin">
        <input type="text" id="to" name="to" placeholder="To"  class="w3-margin">

        <input type="datetime-local" id="arrTime" data-date-inline-picker="true" name="arrival to"
               placeholder="Arrival date and time" class="w3-margin">
    </form>


    <button class = "w3-margin-bottom" type="button" id="main_button"  onclick="createFunction() "  >Create</button>


</div>

<div>

    <h2 class="w3-wide w3-margin">Delete Route</h2>

    <form class="w3-margin-bottom">

        <input type="text" id="trainID2" name="trainID" placeholder="Train number" class="w3-margin">

        <input type="text" id="from2" name="from" placeholder="From"  class="w3-margin">

        <input type="datetime-local"  id="depTime2" data-date-inline-picker="true" name="departure from"
               placeholder="Departure date and time" class="w3-margin">
        <input type="text" id="to2" name="to" placeholder="To"  class="w3-margin">

        <input type="datetime-local" id="arrTime2" data-date-inline-picker="true" name="arrival to"
               placeholder="Arrival date and time" class="w3-margin">
    </form>


    <button class = "w3-margin-bottom" type="button" id="main_button"  onclick="deleteFunction() "  >Delete</button>


</div>



<script>

    function updateSchedule(items) {
        $("#table_of_schedule tbody tr").remove();
        $("#table_of_schedule").html("");
        items = JSON.parse(items);

        items.forEach(function (index) {

            var depTime = index.depTime;
            var arrivalTime = index.arrivalTime;
            var depStationName = index.depName;
            var arrivalStationName = index.arrivalName;
            var trainId = index.trainId;
            var availability = index.availability;
            var routeIs = index.routeIsClosed;
            var maintenanceR = index.maintenanceR;


            $("#tableSchedule").append("<tr><td class=\"column1\">"
                + trainId + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column2\">"
                + depTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column3\">"
                + arrivalTime + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column4\">"
                + depStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                + arrivalStationName + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                + availability + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                + routeIs + "</td><button type='button' onclick='bookFunction()'>book</button><br><td class=\"column5\">"
                + maintenanceR + "</td><button type='button' onclick='bookFunction()'>book</button><br></tr><br>");
        });
    }

    function getSchedule(){
        $.get("api/", {
                },

            function(r) {
                updateSchedule(r);
            });
    }

    function createFunction() {

        var from = $('#from').val();
        var to = $('#to').val();
        var depTime = $('#depTime').val();
        var arrTime = $('#arrTime').val();
        var trainID = $('#trainID').val();

        $.get("api/", {

            },

            function (r) {
                updateSchedule(r);

            });
    }

    function deleteFunction() {

        var from = $('#from2').val();
        var to = $('#to2').val();
        var depTime = $('#depTime2').val();
        var arrTime = $('#arrTime2').val();
        var trainID = $('#trainID2').val();

        $.get("api/", {

            },

            function (r) {
                updateSchedule(r);

            });
    }

    $(document).ready(function (){
        getSchedule();

    });

</script>



</body>
</html>